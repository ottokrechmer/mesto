(()=>{"use strict";var e=document.querySelector(".popup-image"),t=e.querySelector(".popup__image"),n=e.querySelector(".popup__description-text");function r(e){e.classList.add("popup_opened"),document.addEventListener("keydown",s)}function o(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",s)}function i(e){e.classList.contains("popup")&&o(e)}function s(e){"Escape"===e.key&&o(document.querySelector(".popup_opened"))}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function o(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this._name=e,this._url=t,this._templateSelector=n}var i,s;return i=o,(s=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".element__button"),this._image=this._element.querySelector(".element__image"),this._image.src=this._url,this._image.alt=this._name,this._element.querySelector(".element__name").textContent=this._name,this._setEventListeners(),this._element}},{key:"_setEventListeners",value:function(){var o=this;this._likeButton.addEventListener("click",(function(e){o._likeButton.classList.toggle("element__button_liked")})),this._element.querySelector(".element__delete-button").addEventListener("click",(function(e){o._element.remove(),o._element=null})),this._image.addEventListener("click",(function(i){t.alt=o._name,t.src=o._url,n.textContent=o._name,r(e)}))}}])&&a(i.prototype,s),Object.defineProperty(i,"prototype",{writable:!1}),o}();function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=n,this._inputList=Array.from(this._form.querySelectorAll(t.inputSelector)),this._button=this._form.querySelector("".concat(t.submitButtonSelector)),this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClassVisible=t.errorClassVisible}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._form.setAttribute("novalidate","novalidate"),this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}},{key:"_setEventListeners",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e.toggleButtonState()}))}))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_showInputError",value:function(e,t){var n=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add("".concat(this._inputErrorClass)),n.textContent=t,n.classList.add("".concat(this._errorClassVisible))}},{key:"_hideInputError",value:function(e){var t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove("".concat(this._inputErrorClass)),t.classList.remove("".concat(this._errorClassVisible)),t.textContent=""}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(){this._hasInvalidInput()?(this._button.classList.add("".concat(this._inactiveButtonClass)),this._button.setAttribute("disabled","disabled")):(this._button.classList.remove("".concat(this._inactiveButtonClass)),this._button.removeAttribute("disabled"))}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),p=document.querySelectorAll(".popup__close-button"),d=document.querySelector(".popup-profile"),_=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),f=d.querySelector("#userName"),v=d.querySelector("#userDescription"),h=document.querySelector(".profile__button_type_edit"),y=d.querySelector(".popup__form"),b=document.querySelector(".popup-card"),k=b.querySelector("#imageName"),g=b.querySelector("#imageUrl"),S=document.querySelector(".profile__button_type_add"),E=b.querySelector(".popup__form"),L=document.querySelector(".elements");function q(e,t){var n=function(e,t){return new u(e,t,"#matrix-element-template").generateCard()}(e,t);L.prepend(n)}[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){q(e.name,e.link)})),function(t){e.addEventListener("click",(function(e){return i(e.target)}));var n=new c(t,y),s=new c(t,E);n.enableValidation(),s.enableValidation(),d.addEventListener("click",(function(e){return i(e.target)})),b.addEventListener("click",(function(e){return i(e.target)})),p.forEach((function(e){e.addEventListener("click",(function(){o(e.closest(".popup"))}))})),h.addEventListener("click",(function(e){f.value=_.textContent,v.value=m.textContent,n.toggleButtonState(),r(d)})),y.addEventListener("submit",(function(e){e.preventDefault(),_.textContent=f.value,m.textContent=v.value,o(d)})),S.addEventListener("click",(function(e){s.toggleButtonState(),r(b)})),E.addEventListener("submit",(function(e){e.preventDefault(),q(k.value,g.value),E.reset(),o(b)}))}({formSelector:".popup__form",inputSelector:".popup__text-input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error",errorClassVisible:"popup__error_visible"})})();